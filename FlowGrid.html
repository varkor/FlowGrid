<!doctype html>
<html>
	<head>
		<title></title>
		<meta charset="utf-8">
		<script src="FlowGrid.js"></script>
		<style>
			*, *::before, *::after {
				box-sizing: border-box;
			}
			body {
				margin: 0;
				background: hsl(200, 30%, 50%);
			}
			canvas {
				margin: 8pt;
				vertical-align: top;
			}
		</style>
	</head>
	<body>
		<script>
			// Arrays which store the actual items â€” these will be manipulated by the FlowGrid
			var itemsX = ["A", "B", "C"];
			var itemsY = ["D", "E", "F"];
			// Bag
			var item = FlowCellTemplate({
				size : {
					width : 64,
					height : 64
				},
				draw : function (context, data, position, size, states) {
					var lightness = 25;
					for (var i = 0; i < states.length; ++ i) {
						switch (states[i]) {
							case "drag":
								lightness += 25;
								break;
							case "select":
								lightness += 15;
								break;
							case "hover":
								lightness += 5;
								break;
						}
					}
					context.fillStyle = "hsl(0, 0%, " + lightness + "%)";
					context.fillRoundedRectHD(Math.round(position.x), Math.round(position.y), size.width, size.height, 4);
					context.fillStyle = "white";
					context.textAlign = "center";
					context.textBaseline = "middle";
					context.setFontHD("Helvetica", 20);
					context.fillTextHD(data, (position.x + size.width / 2), (position.y + size.height / 2));
				}
			});
			var bagX = FlowGrid({
				template : item,
				datasource : itemsX,
				rows : 5,
				columns : 5,
				contrainToBounds : false,
				selection : "multiple",
				margin : {
					x : 8,
					y : 8
				},
				spacing : {
					x : 8,
					y : 8
				},
				draw : function (context, size, region) {
					context.fillStyle = "hsl(0, 0%, 10%)";
					context.fillRectHD(region.origin.x, region.origin.y, region.size.width, region.size.height);
				}
			});
			var tabs1 = FlowAdjunct({
				data : {
					active : true
				},
				size : {
					width : 64,
					height : 24
				},
				listeners : {
					click : function (data, host, position, size, pointer) {
						if (pointer.x - position.x >= 0 && pointer.y - position.y >= 0 && pointer.x - position.x < size.width && pointer.y - position.y < size.height) {
							data.active = !data.active;
							return true;
						} else {
							return false;
						}
					}
				},
				draw : function (context, data, position, size) {
					if (data.active) {
						context.fillStyle = "hsl(100, 50%, 50%)";
					} else {
						context.fillStyle = "hsl(0, 50%, 50%)";
					}
					context.fillRectHD(position.x, position.y, size.width, size.height);
				}
			});
			var tabs2 = FlowAdjunct({
				data : {
					active : true
				},
				size : {
					width : 64,
					height : 24
				},
				listeners : {
					click : function (data, host, position, size, pointer) {
						if (pointer.x - position.x >= 0 && pointer.y - position.y >= 0 && pointer.x - position.x < size.width && pointer.y - position.y < size.height) {
							data.active = !data.active;
							return true;
						} else {
							return false;
						}
					}
				},
				draw : function (context, data, position, size) {
					if (data.active) {
						context.fillStyle = "hsl(200, 50%, 50%)";
					} else {
						context.fillStyle = "hsl(0, 50%, 50%)";
					}
					context.fillRectHD(position.x, position.y, size.width, size.height);
				}
			});
			var tabs = FlowAdjunct.fromAdjuncts([{
					adjunct : tabs1,
					position : { x : 0, y : 0 }
				}, {
					adjunct : tabs2,
					position : { x : tabs1.size.width, y : 0 }
				}
			]);
			var bagY = FlowGrid({
				template : item,
				datasource : itemsY,
				rows : 5,
				columns : 5,
				contrainToBounds : true,
				selection : "none",
				margin : {
					x : 8,
					y : 8,
					top : tabs.size.height + 2 * 8
				},
				spacing : 8,
				draw : function (context, size, region) {
					context.fillStyle = "hsl(0, 0%, 10%)";
					context.fillRectHD(region.origin.x, region.origin.y, region.size.width, region.size.height);
				}
			});
			bagY.attachAdjunct(tabs, { x : 8, y : 8 });
			window.addEventListener("DOMContentLoaded", function () {
				document.body.appendChild(bagX.canvas);
				document.body.appendChild(bagY.canvas);
			});
		</script>
	</body>
</html>